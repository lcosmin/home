#!/bin/bash

#
# Settings
#
src_dir=$(dirname $0)
backup_dir="$HOME/.backup"
install_files=(".zshrc" 
               ".antigen-repo" 
               ".oh-my-zsh-plugins")


die() {
    echo "$1"
    exit 1
}

create_backup_dir() {
    [[ -d "$HOME" ]] || die "Home directory doesn't exist!"
    mkdir -p $backup_dir
}

install_file() {
    if [[ ! -f "$1" ]] 
    then
        return
    fi
    echo "installing \"$1\"..."
    
    name=$(basename "$1")
    dest="~/$name"
    
    if [[ -f "$dest" ]]
    then
        echo "backing up $dest to \"$backup_dir/$name\""
        mv -rf "$dest" "$backup_dir/$name"
    fi
    
    ln -sfn "$1" "$dest"
}

create_backup_dir

for file in ${install_files[@]}
do
    install_file "$src_dir/$file"
done